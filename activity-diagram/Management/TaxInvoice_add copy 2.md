@startuml
start

title ขอใบกำกับภาษี

if(มีการสร้างบิลไว้แล้วหรือไม่)then(ไม่มี)
:ทำการสร้างบิลใหม่;

if(ลูกค้ามีการเข้าพักที่โรงแรมใช่หรือไม่ (X)) then(ใช่)
:ดึงข้อมูลผู้เข้าพัก;
 note left
 รายชื่อต้นๆคือคนที่แจ้งว่าต้องการใบกำกับภาษี (แจ้งตอน checkin)
 endnote
else(ไม่ใช่)
endif

if(ต้องการเพิ่มหรือแก้ไขข้อมูลใช่หรือไม่ (Y))then(ใช่)
:กรอกข้อมูล;
:บันทึกข้อมูล;
else(ไม่ใช่)
endif

:สร้างบิลใหม่;
 note left
 1.มีการบันทึกเลขที่ใบกำกับภาษี (Running No.)
 2.ขึ้นสถานะรอการยืนยันข้อมูล
 3.หาก(X)และ(Y) = ไม่ใช่ จะไม่สามารถสร้างบิลใหม่ได้
 endnote

(A)
 note left
 สถานะรอการยืนยันข้อมูล
 endnote
if(ต้องการเพิ่มหรือแก้ไขข้อมูลใช่หรือไม่)then(ใช่)
:กรอกข้อมูล;
:บันทึกข้อมูล;
else(ไม่ใช่)
endif

if(ต้องการคิดเงินใช่หรือไม่)then(ใช่)
:คิดเงินและบันทึก;
note left
1.มีการคำนวณค่าoverbill
2.สถานะถูกเปลี่ยนเป็นยืนยันข้อมูลแล้ว
endnote
else(ไม่ใช่) 
stop
endif


else(มี)
endif

if(เป็นสถานะยืนยันข้อมูลแล้ว หรือ รอการยืนยันข้อมูล) then(สถานะยืนยันข้อมูลแล้ว) 

:ต้องการทำรายการใดต่อไปนี้;
->เลือกรายการที่ต้องการทำ;

fork
  :พิมพ์ใบกำกับภาษี;
  :สั่งพิมพ์;
fork again
  :ยกเลิกใบกำกับภาษี;
  note left
  ข้อมูลที่ยืนยันแล้วหากต้องการแก้ไขต้องทำการยกเลิกแล้วสร้างบิลใหม่เท่านั้น
  endnote
  :ยืนยันการยกเลิก;
  :บันทึก;
  note left
  สถานะถูกเปลี่ยนเป็นยกเลิกแล้ว
  endnote
end fork
stop

else(รอการยืนยันข้อมูล)
(A)
endif


@enduml
